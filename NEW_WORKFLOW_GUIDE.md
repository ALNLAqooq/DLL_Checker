# DLL依赖检查工具 - 新工作流程指南

## 概述

新的工作流程简化了开发机和目标机之间的DLL补齐操作，不再需要开发机预先导出清单。

## 工作流程

### 目标机操作（缺少DLL的机器）

1. **启动程序**
   - 运行 DLLChecker.exe

2. **扫描文件夹**
   - 点击工具栏的"扫描文件夹"按钮
   - 选择需要检查的应用程序文件夹
   - 等待扫描完成

3. **导出缺失报告**
   - 点击工具栏的"导出缺失报告"按钮
   - 选择保存位置（例如：`missing_report.json`）
   - 系统会生成一个JSON文件，只包含缺失的DLL名称列表

4. **传输报告文件**
   - 将生成的 `missing_report.json` 文件拷贝到U盘或通过网络传输到开发机

### 开发机操作（库完整的机器）

1. **启动程序**
   - 运行 DLLChecker.exe

2. **扫描文件夹**
   - 点击工具栏的"扫描文件夹"按钮
   - 选择与目标机相同的应用程序文件夹（或包含所有DLL的文件夹）
   - 等待扫描完成，系统会显示完整的依赖树

3. **导入差异报告**
   - 点击工具栏的"导入差异报告"按钮
   - 选择从目标机拷贝过来的 `missing_report.json` 文件
   - 系统会自动：
     * 在依赖树中查找报告中列出的缺失DLL
     * 用**黄色背景 + 粗体**高亮显示这些DLL
     * 自动展开包含高亮DLL的所有父节点路径
   - 显示找到的高亮DLL数量和路径

4. **一键补齐**
   - 点击工具栏的"一键补齐"按钮
   - 系统会显示所有高亮DLL的列表和总大小
   - 确认后，选择目标文件夹（用于保存收集的DLL）
   - 选择冲突处理策略：
     * 全部覆盖：覆盖已存在的同名文件
     * 全部跳过：跳过已存在的同名文件
   - 系统开始复制，显示进度条
   - 完成后显示结果摘要（成功/失败数量）
   - 可以点击"打开目标文件夹"查看收集的DLL

5. **传输DLL到目标机**
   - 将收集的DLL文件夹拷贝到U盘或通过网络传输到目标机
   - 在目标机上将DLL复制到应用程序目录

## 视觉标识

- **红色文字**：缺失的DLL（在扫描结果中）
- **黄色背景 + 粗体**：高亮的DLL（需要补齐的）
- **橙色文字**：架构不匹配的DLL
- **正常文字**：正常的DLL

## 文件格式

### 缺失报告 (missing_report.json)

```json
{
    "generated_time": "2026-01-14T20:30:00",
    "target_machine": "TargetPC",
    "missing_dlls": [
        "MyLib.dll",
        "opencv_core.dll",
        "Qt5Core.dll"
    ]
}
```

## 优势

1. **简化流程**：不需要开发机预先导出清单
2. **直观显示**：高亮显示需要补齐的DLL，一目了然
3. **自动展开**：自动展开包含高亮DLL的路径，无需手动查找
4. **一键操作**：点击一次即可收集所有需要的DLL
5. **进度显示**：实时显示复制进度和文件大小
6. **错误处理**：详细记录失败的文件和原因

## 注意事项

1. 确保在开发机上扫描的文件夹包含所有需要的DLL
2. 如果某些DLL在开发机上也不存在，会在一键补齐时显示失败
3. 建议在开发机上扫描完整的Release文件夹，确保包含所有依赖
4. 高亮显示基于DLL文件名匹配（不区分大小写）
